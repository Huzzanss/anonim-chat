<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat Anomim</title>

<style>
body{
    margin:0;
    font-family: system-ui;
    background:#0f172a;
    color:white;
    display:flex;
    flex-direction:column;
    height:100vh;
}

header{
    padding:15px;
    text-align:center;
    font-weight:bold;
    background:#020617;
    box-shadow:0 2px 10px rgba(0,0,0,.5);
}

#chat{
    flex:1;
    overflow-y:auto;
    padding:15px;
}

.msg{
    background:#1e293b;
    padding:10px;
    border-radius:12px;
    margin-bottom:10px;
    max-width:80%;
    word-wrap:break-word;
}

.me{
    background:#2563eb;
    margin-left:auto;
}

form{
    display:flex;
    padding:10px;
    gap:10px;
    background:#020617;
}

input{
    flex:1;
    padding:12px;
    border-radius:10px;
    border:none;
    outline:none;
}

button{
    padding:12px 18px;
    border:none;
    border-radius:10px;
    background:#22c55e;
    color:white;
    font-weight:bold;
}

button:active{
    transform:scale(.95);
}
</style>
</head>
<body>

<header>ðŸ’¬ Chat Anonim</header>

<div id="chat"></div>

<form onsubmit="send(event)">
    <input id="msg" placeholder="Tulis pesan..." autocomplete="off"/>
    <button>Kirim</button>
</form>


<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
firebase.initializeApp({
    apiKey: "AIzaSyDIRVKsEXcaxxsrYr-6z7-AAakvgsfkFLo",
    authDomain: "anonim-chat-web.firebaseapp.com",
    databaseURL: "https://anonim-chat-web-default-rtdb.asia-southeast1.firebasedatabase.app/",
    projectId: "anonim-chat-web"
});

const db = firebase.database().ref("messages");
const chat = document.getElementById("chat");

// random username
const username = "User" + Math.floor(Math.random()*9999);

// kirim pesan
function send(e){
    e.preventDefault();

    const input = document.getElementById("msg");
    const text = input.value.trim();

    if(text === "") return;

    db.push({
        user: username,
        text: text
    });

    input.value="";
}

// tampilkan pesan realtime
db.limitToLast(100).on("child_added", snapshot=>{
    const data = snapshot.val();

    const div = document.createElement("div");

    div.className = "msg";

    if(data.user === username){
        div.classList.add("me");
        div.innerHTML = `<b>Kamu</b><br>${data.text}`;
    }else{
        div.innerHTML = `<b>${data.user}</b><br>${data.text}`;
    }

    chat.appendChild(div);

    // auto scroll
    chat.scrollTop = chat.scrollHeight;
});
</script>

</body>
</html>
